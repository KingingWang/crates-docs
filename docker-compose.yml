version: '3.8'

services:
  crates-docs:
    build: .
    container_name: crates-docs
    ports:
      - "8080:8080"
    volumes:
      - ./examples/config.example.toml:/app/config.toml
      - ./logs:/app/logs
      - ./data:/app/data
    environment:
      - RUST_LOG=info
    restart: unless-stopped
    networks:
      - crates-docs-network

  # Redis 服务（可选，用于 Redis 缓存）
  # 如需使用 Redis 缓存，请：
  # 1. 取消下面 redis 服务的注释
  # 2. 在 config.toml 中设置 cache_type = "redis" 和 redis_url = "redis://redis:6379"
  # 3. 启用 cache-redis feature（修改 Dockerfile：RUN cargo build --release --features cache-redis）
  #
  # redis:
  #   image: redis:7-alpine
  #   container_name: crates-docs-redis
  #   ports:
  #     - "6379:6379"
  #   volumes:
  #     - redis-data:/data
  #   restart: unless-stopped
  #   networks:
  #     - crates-docs-network

volumes:
  redis-data:
    driver: local

networks:
  crates-docs-network:
    driver: bridge